<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>寂寞先生</title>

    <meta name="author" content="陈佳伟">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/site/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/site/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/site/assets/themes/twitter/css/prettify.css" rel="stylesheet" type="text/css">
    <script src="/site/assets/themes/twitter/js/prettify.js"></script>
    <!-- Le fav and touch icons -->
    <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/site/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/site/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

    <!--    font-awesome-->
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

</head>

<body onload="prettyPrint()">
    <div class="navbar">
        <div class="navbar-inner">
            <div class="nav-narrow">
                <a class="brand" href="/site"><span class="fa fa-mortar-board (alias)">寂寞先生</span></a>
                <ul class="nav">









                    <li><a href="/site/archive.html">文章</a>
                    </li>










                    <li><a href="/site/categories.html">分类</a>
                    </li>










                    <li><a href="/site/pages.html">页面</a>
                    </li>










                    <li><a href="/site/tags.html">标签</a>
                    </li>







                </ul>
            </div>
        </div>
    </div>

    <div class="container-narrow">

        <div class="content">

            <!--
<div class="page-header">
  <h1>寂寞先生  <small>这，是一个寂寞的世界……</small></h1>
</div>
-->

            <div class="row-fluid">
                <div class="span12">

                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                05/24
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>canvas总结之图像处理</h1>

                        <hr />

                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/05/24/canvas-image">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                05/24
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>canvas总结之Pixel Manipulation</h1>

                        <hr />

                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/05/24/canvas-Pixel-Manipulation">  查看全文&hellip;</a>
                        </div>

                    </div>


                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                05/23
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>canvas 总结之动画</h1>

                        <hr />
                        <form class="inputTime" method="get" action="">
                            <input type="text" id="endTime" placeholder="输入倒计时时间" class="input text" value="10">
                            <input type="button" value="倒计时" id="startCountdown" class="big button">
                            <input type="button" value="停止倒计时" id="pauseCountdown" class="big button">

                        </form>
                        <canvas id="canvasOfClock"></canvas>

                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/05/23/canvas_countdown">  查看全文&hellip;</a>
                        </div>

                    </div>
                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                05/21
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>canvas总结之method</h1>

                        <hr />
                        <h2>canvas介绍</h2>

                        <p><code>canvas</code>还没出现之前，开发人员通常使用 SVG，VML 等技术进行 Web 绘图操作，但这些基于XML的绘图语言声明式的绘图方式并不能满足复杂绘图操作在性能上的需求，特别是需要像素级别绘图能力的游戏。canvas提供了一系列用于绘图的API,我们可以使用JavaScript脚本语言在canvas中进行一系列基于命令的图形绘制操作。我们的绘图和动画终于可以摆脱第三方插件了，虽然前端的标准问题始终是个大坑。</p>

                        <p><code>&lt;canvas id="canvas"&gt;&lt;/canvas&gt;</code> 这就是canvas，它就是一个html标签，它除了提供一块画布和一系列的API让你可以在javascript中使用之外，看上去什么都没有。但是一块画布和一系列API就等于给了你一张纸和一套画图工具，你可以在上面发挥你的想象，至于画什么以及画的好不好那就是开发者功底的事了。接下来主要是对canvas的API进行分类和总结。</p>

                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/05/21/canvas-method">  查看全文&hellip;</a>
                        </div>

                    </div>

                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                05/20
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>HTTP协议的简析</h1>

                        <hr />

                        <p>HTTP协议是一种可靠的数据传输协议，位于应用层，在TCP协议的上层。我们现在使用的web服务几乎都是建立在HTTP协议之上，HTTP是互联网通信的公共语言。</p>

                        <p>从宏观角度来看，HTTP连接是一个很简单的过程，客户端发起请求，服务端相应响应的数据，断开连接。这就是一个完整的连接过程，我们每天上网都在经历这个过程，当你访问一个url时，浏览器会把这个url进行解析，通过dns获取域名对应的IP地址，然后向这个IP地址发送一个HTTP请求，告诉服务器我需要什么数据，服务器处理这个HTTP请求后调用对应的资源，给客户端一个HTTP响应，这个响应中就包含了我们请求的资源。</p>
                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/05/20/HTTP">  查看全文&hellip;</a>
                        </div>
                    </div>


                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                05/20
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>收藏颜色的工具</h1>

                        <hr />

                        <p>
                            <img src="http://enml.github.io/blog/image/collect_color.jpg" alt="collect_color" />
                        </p>

                        <p>用了三个小时完成了上图的功能，满足了我的需求。</p>

                        <p>只要在输入框输入颜色数值，便可记录到数据库，并把颜色作为该数值背景色输出页面。</p>


                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/05/20/collect_color">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                05/10
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>Template</h1>

                        <hr />

                        <p><strong>在view里面，我们获取了相关的数据，但我们的目的是将数据呈现出来。</strong>
                        </p>

                        <p>于是：</p>

                        <p><strong>1.首先我们想到的是直接把数据硬编码到html代码里面，然后通过<code>HttpResponse</code>对象传递给浏览器进行渲染：</strong>
                        </p>

                        <pre><code>from django.http import HttpResponse
import datetime

def current_datetime(request):
    now = datetime.datetime.now()
    html = "&lt;html&gt;&lt;body&gt;It is now %s.&lt;/body&gt;&lt;/html&gt;" % now
    return HttpResponse(html)
</code></pre>


                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/05/10/template">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                05/03
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>view传递context的方式</h1>

                        <hr />

                        <p><strong> 通过view的render()方法填充template可以有以下方式：</strong>
                        </p>

                        <p>1.适合于数据量小且静态的数据。在template中直接使用相关键值为标签：
                            <code></code>
                        </p>

                        <pre><code>def test1(request):
    return render(request,'test/raw.htm',{
                'name':'Enm',
                'age':22,
                'company': 'Outdoor Equipment',
                'ship_date': datetime.datetime.now(),
                'ordered_warranty': False})
</code></pre>


                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/05/03/view_render">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                04/27
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>install jekyll 流程</h1>

                        <hr />

                        <ul>
                            <li>
                                <p>首先下载<code>ruby</code><a href="http://rubyinstaller.org/downloads/">安装ruby download</a> ，然后下载<strong>DevKit-mingw64-64-4.7.2-20130224-1432-sfx.exe</strong>。安装完<code>ruby</code>后，再安装<code>rubyGems</code>:运行<code>gem update --system</code>即可。</p>
                            </li>
                            <li>
                                <p>解压DevKit，然后命令行cd到该目录，运行</p>
                            </li>
                        </ul>



                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/04/27/install-jekyll">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                04/25
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>Python list的一些技巧</h1>

                        <hr />

                        <p>列表相邻元素压缩器</p>

                        <pre><code>&gt;&gt;&gt; a = [1, 2, 3, 4, 5, 6]
&gt;&gt;&gt; zip(*([iter(a)] * 2))
[(1, 2), (3, 4), (5, 6)]
&gt;&gt;&gt; group_adjacent = lambda a, k: zip(*([iter(a)] * k))
&gt;&gt;&gt; group_adjacent(a, 3)
[(1, 2, 3), (4, 5, 6)]
&gt;&gt;&gt; group_adjacent(a, 2)
[(1, 2), (3, 4), (5, 6)]
&gt;&gt;&gt; group_adjacent(a, 1)
[(1,), (2,), (3,), (4,), (5,), (6,)]
&gt;&gt;&gt; zip(a[::2], a[1::2])
[(1, 2), (3, 4), (5, 6)]
&gt;&gt;&gt; zip(a[::3], a[1::3], a[2::3])
[(1, 2, 3), (4, 5, 6)]
&gt;&gt;&gt; group_adjacent = lambda a, k: zip(*(a[i::k] for i in range(k)))
&gt;&gt;&gt; group_adjacent(a, 3)
[(1, 2, 3), (4, 5, 6)]
&gt;&gt;&gt; group_adjacent(a, 2)
[(1, 2), (3, 4), (5, 6)]
&gt;&gt;&gt; group_adjacent(a, 1)
[(1,), (2,), (3,), (4,), (5,), (6,)]
</code></pre>


                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/04/25/python-code">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                04/24
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>jekyll加载图片的路径问题</h1>

                        <hr />

                        <p>　一开始使用根目录<code>/assets/…/img/bg.png</code>的方式，在localhost调试成功，但在github pages失败。 　后来试了一下当前目录方式
                            <code>./img/bg.png</code>成功。也可以用<code>img/bg.png</code>表示当前目录。</p>


                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/04/24/directory">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                04/23
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>完成基于jekyll的第一个blog</h1>

                        <hr />

                        <p>　今天差不多把blog完成了，这是我第一个基于jekyll的blog，定制了主题，修改了相关配置，以及解决了中文bug。现在把这5天的心得分享一下：</p>

                        <ul>
                            <li>首先是中文问题，这个困扰我了很久，也花费了不少时间，不过最后总算找到解决办法。给我最大的感触就是，即使碰壁，也得硬着头皮找下去，如果放弃，那就前功尽弃了。</li>
                        </ul>



                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/04/23/finish-jekyll">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                04/23
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>解决invalid byte sequence in GBK</h1>

                        <hr />

                        <p>　jekyll对中文的支持不太好，导致经常出现乱码甚至无法运行<code>jekyll server</code>命令。解决post内容乱码问题可以通过修改convertible.rb文件的第27行：</p>

                        <pre><code>self.content = File.read(File.join(base, name));
</code></pre>

                        <p>为</p>

                        <pre><code>self.content = File.read(File.join(base, name), :encoding =&gt; "utf-8");
</code></pre>

                        <p>　原因File.read()可能采用系统默认编码读取文件，中文系统为GBK，但markdown文件均为utf-8编码，所以导致无法正确展现中文。</p>


                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/04/23/chinese-messy-code">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                04/21
                            </div>
                            <div class="year">
                                2014
                            </div>
                        </div>
                        <h1>谁将取代智能手机</h1>

                        <hr />

                        <p>
                            <img src="http://www.wccbr.com/wp-content/uploads/2013/03/Robot_Wallpaper_1.jpg" alt="robot" />
                        </p>

                        <h3><strong>智能手表</strong></h3>

                        <p>　现在手表被炒的很热，但以目前来看，手表只是一个辅佐设备；注定手表不可能超越智能手机。手表的特点在于屏幕小，便携，查看信息快速直接；但屏幕小也是它的极限性（屏幕扩大了跟智能手机就没差别了），决定了它不适合发展成独立的终端，你能想象拿着手表刷微博看知乎发邮件吗？</p>


                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2014/04/21/future">  查看全文&hellip;</a>
                        </div>

                    </div>




                    <div class="card">
                        <div class="date_label">
                            <div class="day_month">
                                01/12
                            </div>
                            <div class="year">
                                2011
                            </div>
                        </div>
                        <h1>js 算出某值以内的质数</h1>

                        <hr />

                        <pre class="prettyprint linenums">
    //算出 num 以内的所有质数
 
function prime(num){
    var list = [];
    for(var i = 2; i <= num; i++){ list.push(i); } //create a Array
    
    for(var i = 0; i < list.length; i++){
        for(var j = 2; j < list[i]; j++){
            if(list[i] % j == 0){
                list.splice(i,1); //delete the non prime number.it will change the index of other elements
                j = 2; //由于splice导致list[i+1]的index变为i,因此把j置为2以便对list[i+1]进行重新计算
        }
    }
}
</pre>


                        <div class="read_more">
                            <a class="fa fa-link" href="/site/2011/01/12/prime">  查看全文&hellip;</a>
                        </div>

                    </div>




                </div>
            </div>


        </div>

        <footer class="card clearfix">
            <span style="font-size:30px;" class="fa fa-github pull-left"></span><a href="https://github.com/enml/blog/tree/jekyll-blog" style="display:inline-block;padding-right:80px;border-right:1px solid #bbb">fork me on GitHub</a>
            <p class="pull-right">&copy; 2011 陈佳伟 with help from <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
            </p>

        </footer>

    </div>

    <script>
        window.onload = canvasDrawClock();
        document.getElementById("startCountdown").addEventListener("click", canvasDrawClock);

        function canvasDrawClock() {
            var digit = [
        [
            [0, 0, 1, 1, 1, 0, 0],
            [0, 1, 1, 0, 1, 1, 0],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [0, 1, 1, 0, 1, 1, 0],
            [0, 0, 1, 1, 1, 0, 0]
        ], //0
        [
            [0, 0, 0, 1, 1, 0, 0],
            [0, 1, 1, 1, 1, 0, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [1, 1, 1, 1, 1, 1, 1]
        ], //1
        [
            [0, 1, 1, 1, 1, 1, 0],
            [1, 1, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 1, 1, 0, 0, 0],
            [0, 1, 1, 0, 0, 0, 0],
            [1, 1, 0, 0, 0, 0, 0],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 1, 1, 1, 1, 1]
        ], //2
        [
            [1, 1, 1, 1, 1, 1, 1],
            [0, 0, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 1, 1, 1, 0, 0],
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [0, 1, 1, 1, 1, 1, 0]
        ], //3
        [
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 1, 1, 1, 0],
            [0, 0, 1, 1, 1, 1, 0],
            [0, 1, 1, 0, 1, 1, 0],
            [1, 1, 0, 0, 1, 1, 0],
            [1, 1, 1, 1, 1, 1, 1],
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 1, 1, 1, 1]
        ], //4
        [
            [1, 1, 1, 1, 1, 1, 1],
            [1, 1, 0, 0, 0, 0, 0],
            [1, 1, 0, 0, 0, 0, 0],
            [1, 1, 1, 1, 1, 1, 0],
            [0, 0, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [0, 1, 1, 1, 1, 1, 0]
        ], //5
        [
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 1, 1, 0, 0, 0],
            [0, 1, 1, 0, 0, 0, 0],
            [1, 1, 0, 0, 0, 0, 0],
            [1, 1, 0, 1, 1, 1, 0],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [0, 1, 1, 1, 1, 1, 0]
        ], //6
        [
            [1, 1, 1, 1, 1, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 0, 1, 1, 0, 0, 0],
            [0, 0, 1, 1, 0, 0, 0],
            [0, 0, 1, 1, 0, 0, 0],
            [0, 0, 1, 1, 0, 0, 0]
        ], //7
        [
            [0, 1, 1, 1, 1, 1, 0],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [0, 1, 1, 1, 1, 1, 0],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [0, 1, 1, 1, 1, 1, 0]
        ], //8
        [
            [0, 1, 1, 1, 1, 1, 0],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [0, 1, 1, 1, 0, 1, 1],
            [0, 0, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 1, 1, 0],
            [0, 0, 0, 1, 1, 0, 0],
            [0, 1, 1, 0, 0, 0, 0]
        ], //9
        [
            [0, 0, 0, 0, 0, 0, 0],
            [0, 0, 1, 1, 1, 0, 0],
            [0, 0, 1, 1, 1, 0, 0],
            [0, 0, 1, 1, 1, 0, 0],
            [0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0],
            [0, 0, 1, 1, 1, 0, 0],
            [0, 0, 1, 1, 1, 0, 0],
            [0, 0, 1, 1, 1, 0, 0],
            [0, 0, 0, 0, 0, 0, 0]
        ] //:
    ];

            var canvas = document.getElementById("canvasOfClock"),
                context = canvas.getContext("2d");
            canvas.width = document.getElementsByClassName("card")[0].offsetWidth - 80;
            canvas.height = 440;
            var ball = {
                    startX: 0.08 * context.canvas.width,
                    startY: 0.1 * context.canvas.height,
                    radius: 0.0055 * context.canvas.width,
                    marginX: 0.006 * context.canvas.width
                },
                newBall = [],
                newBallColor = ["rgb(0,157,148)", "rgb(197,214,74)", "rgb(222,106,115)", "rgb(0,173,207)", "rgb(254,100,98)", "rgb(107,133,131)", "rgb(249,29,101)", "#D45255", "#fef1de", "#333"],
                curent = new Date().getTime(),
                endTime = curent + (document.getElementById("endTime").value) * 1000,
                curentShowTime = countdownTime();




            var start = setInterval(function () {
                    renderTime();
                    updateTime();
                    fallAnimation();
                },
                50
            );
            //clear setinterval() when click the "start" button again to prevent double setInterval() 
            document.getElementById("startCountdown").addEventListener("click", function () {
                clearInterval(start)
            });
            //clear setInterval() when click the "pause" button
            document.getElementById("pauseCountdown").addEventListener("click", function () {
                clearInterval(start)
            });

            function countdownTime() {
                var curentTime = new Date().getTime(),
                    countdownTime = Math.round((endTime - curentTime) / 1000);
                return countdownTime >= 0 ? countdownTime : 0;
            }
            //render number
            function renderTime() {
                canvas.width = document.getElementsByClassName("card")[0].offsetWidth - 80;
                var hours = parseInt(curentShowTime / 3600),
                    minutes = parseInt((curentShowTime % 3600) / 60),
                    seconds = parseInt(curentShowTime % 60);
                context.clearRect(0, 0, context.canvas.width, context.canvas.height);
                drawClock(ball.startX, ball.startY, parseInt(hours / 10), context);
                drawClock(ball.startX + 14 * ball.radius + 18 + ball.marginX, ball.startY, parseInt(hours % 10), context);
                drawClock(ball.startX + 2 * (14 * ball.radius + 18 + ball.marginX), ball.startY, 10, context);
                drawClock(ball.startX + 3 * (14 * ball.radius + 18 + ball.marginX), ball.startY, parseInt(minutes / 10), context);
                drawClock(ball.startX + 4 * (14 * ball.radius + 18 + ball.marginX), ball.startY, parseInt(minutes % 10), context);
                drawClock(ball.startX + 5 * (14 * ball.radius + 18 + ball.marginX), ball.startY, 10, context);
                drawClock(ball.startX + 6 * (14 * ball.radius + 18 + ball.marginX), ball.startY, parseInt(seconds / 10), context);
                drawClock(ball.startX + 7 * (14 * ball.radius + 18 + ball.marginX), ball.startY, parseInt(seconds % 10), context);
                //数字变动时添加新的小球在上面
                for (var i = 0; i < newBall.length; i++) {
                    context.beginPath();
                    context.arc(newBall[i].x, newBall[i].y, ball.radius, 0, 2 * Math.PI, false);
                    context.closePath();
                    context.fillStyle = newBall[i].color;
                    context.fill();
                }
            }
            //draw
            function drawClock(startX, startY, num, context) {
                for (var row = 0; row < 10; row++) {
                    for (var column = 0; column < 7; column++) {
                        if (digit[num][row][column] == 1) {
                            context.beginPath();
                            context.arc(startX + ball.radius + 2 * column * (ball.radius + 1), startY + ball.radius + 2 * row * (ball.radius + 1), ball.radius, 0, 2 * Math.PI, false);
                            context.closePath();
                            context.fillStyle = "rgb(222,106,115) ";
                            context.fill();

                        }
                    }
                }
            }



            //check number which changed and then addBall() to it
            function updateTime() {
                var nextTime = countdownTime();
                var nextHours = parseInt(nextTime / 3600),
                    nextMinutes = parseInt((nextTime % 3600) / 60),
                    nextSeconds = parseInt(nextTime % 60);
                var curentHours = parseInt(curentShowTime / 3600),
                    curentMinutes = parseInt((curentShowTime % 3600) / 60),
                    curentSeconds = parseInt(curentShowTime % 60);
                if (nextTime != curentShowTime) {
                    if (parseInt(nextHours / 10) != parseInt(curentHours / 10)) {
                        addBall(ball.startX, ball.startY, parseInt(nextHours / 10));
                    }
                    if (parseInt(nextHours % 10) != parseInt(curentHours % 10)) {
                        addBall(ball.startX + 14 * ball.radius + 18 + ball.marginX, ball.startY, parseInt(nextHours % 10));
                    }
                    if (parseInt(nextMinutes / 10) != parseInt(curentMinutes / 10)) {
                        addBall(ball.startX + 3 * (14 * ball.radius + 18 + ball.marginX), ball.startY, parseInt(nextMinutes / 10));
                    }
                    if (parseInt(nextMinutes % 10) != parseInt(curentMinutes % 10)) {
                        addBall(ball.startX + 4 * (14 * ball.radius + 18 + ball.marginX), ball.startY, parseInt(nextMinutes % 10));
                    }
                    if (parseInt(nextSeconds / 10) != parseInt(curentSeconds / 10)) {
                        addBall(ball.startX + 6 * (14 * ball.radius + 18 + ball.marginX), ball.startY, parseInt(nextSeconds / 10));
                    }
                    if (parseInt(nextSeconds % 10) != parseInt(curentSeconds % 10)) {
                        addBall(ball.startX + 7 * (14 * ball.radius + 18 + ball.marginX), ball.startY, parseInt(nextSeconds % 10));
                    }

                    curentShowTime = nextTime;

                }
            }
            //the addBall() function
            function addBall(x, y, num) {
                for (var iy = 0, len = digit[num].length; iy < len; iy++) {
                    for (var ix = 0, len = digit[num][iy].length; ix < len; ix++) {
                        if (digit[num][iy][ix] == 1) {
                            var atom = {
                                x: x + ball.radius + 2 * ix * (ball.radius + 2),
                                y: y + ball.radius + 2 * iy * (ball.radius + 2),
                                Vx: Math.pow(-1, parseInt(Math.random() * 1000)) * Math.ceil(Math.random() * 5),
                                Vy: -6,
                                a: 1.5 + Math.random(),
                                color: newBallColor[parseInt(Math.random() * 10)]
                            };
                            newBall.push(atom);
                        }
                    }
                }
            }
            //the  fall down animation of balls
            function fallAnimation() {
                for (var i = 0; i < newBall.length; i++) {
                    newBall[i].x += newBall[i].Vx;
                    newBall[i].y += newBall[i].Vy;
                    newBall[i].Vy += newBall[i].a;
                    bounces();

                    function bounces() {
                        //反弹效果
                        if (newBall[i].y >= (context.canvas.height - ball.radius)) {
                            newBall[i].y = (context.canvas.height - ball.radius);
                            newBall[i].Vy = -newBall[i].Vy * 0.75;
                        }
                        //delete the ball outside
                        if (newBall[i].x + ball.radius < 0 || newBall[i].x - ball.radius > context.canvas.width) {
                            newBall.splice(i, 1);
                            i--;

                        }
                        //停止interval当全部小球已滚出画面
                        if (newBall.length == 0) {
                            clearInterval(start);
                        }
                    }
                }
            }


        }
    </script>
</body>

</html>

